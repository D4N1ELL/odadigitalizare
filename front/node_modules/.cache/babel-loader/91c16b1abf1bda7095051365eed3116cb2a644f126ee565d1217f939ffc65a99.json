{"ast":null,"code":"var _jsxFileName = \"/home/liviu/ODA/front/src/components/ExcelExportButton/index.js\",\n  _s = $RefreshSig$();\nimport * as XLSX from \"xlsx\";\nimport { saveAs } from \"file-saver\";\nimport React, { useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ExcelExportButton = ({\n  data\n}) => {\n  _s();\n  useEffect(() => {\n    console.log(\"Data passed to ExcelExportButton:\", data); // Log the data\n  }, [data]);\n  const exportToExcel = () => {\n    const wb = XLSX.utils.book_new();\n    const wsData = [];\n\n    // Define the static headers\n    const staticHeaders = [\"Nume Prenume\", \"IDNP\", \"Data nașterii\", \"Vârsta\", \"Localitate\", \"Telefon\", \"E-mail\", \"Programul la care aplică\", \"Persoana care a apelat\", \"Data confirmării recepționării formularului / Data apelului\", \"Comentariu în urma discuției\", \"Statut în urma discuției\", \"Participare la instruire\", \"Certificat obținut\", \"Aplicat la finanțare\", \"Statut în urma evaluării planului de afaceri\", \"Excluderea din baza de date\"];\n\n    // Add dynamic headers for application dates and notices\n    let maxApplicationDates = 0;\n    data.forEach(person => {\n      if (person.application_dates.length > maxApplicationDates) {\n        maxApplicationDates = person.application_dates.length;\n      }\n    });\n    const dynamicHeaders = [];\n    for (let i = 0; i < maxApplicationDates; i++) {\n      dynamicHeaders.push(`Data aplicării ${i + 1}`);\n    }\n\n    // Combine static and dynamic headers\n    const headers = [...staticHeaders, ...dynamicHeaders];\n    wsData.push(headers);\n\n    // Map through data to create rows as per the provided template\n    data.forEach(person => {\n      const row = [person.user_data.username || 'N/A', person.user_data.idnp || 'N/A', person.user_data.bday || 'N/A', person.user_data.age || 'N/A', person.user_data.loc_name || 'N/A', person.user_data.phone_number || 'N/A', person.user_data.email || 'N/A', person.user_data.program_name || 'N/A', person.user_data.operator || 'N/A', person.user_data.confirmation_date || 'N/A', person.user_data.comment || 'N/A', person.user_data.status || 'N/A', person.instruction_groups.join(\", \") || 'N/A', person.user_data.certificate || 'N/A', person.user_data.finance || 'N/A', person.user_data.final_status || 'N/A', person.user_data.exclusion ? 'Exclus' : 'N/A'];\n\n      // Add dynamic data for application dates\n      for (let i = 0; i < maxApplicationDates; i++) {\n        row.push(person.application_dates[i] || 'N/A');\n      }\n      wsData.push(row);\n    });\n\n    // Debugging: Log the wsData array to ensure it has the correct data\n    console.log(wsData);\n\n    // Create worksheet\n    const ws = XLSX.utils.aoa_to_sheet(wsData);\n\n    // Adjust column width for readability\n    const columnWidths = headers.map(header => ({\n      wch: header.length + 5\n    }));\n    ws[\"!cols\"] = columnWidths;\n\n    // Append worksheet to workbook\n    XLSX.utils.book_append_sheet(wb, ws, 'PersonDetails');\n\n    // Write workbook and save as file\n    const wbout = XLSX.write(wb, {\n      bookType: \"xlsx\",\n      type: \"array\"\n    });\n    const blob = new Blob([wbout], {\n      type: \"application/octet-stream\"\n    });\n    saveAs(blob, \"PersonDetails.xlsx\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: buttonContainerStyle,\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: exportToExcel,\n      style: buttonStyle,\n      children: \"Export to Excel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcelExportButton, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = ExcelExportButton;\nconst buttonContainerStyle = {\n  backgroundColor: \"#213b8b\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  height: \"42vh\"\n};\nconst buttonStyle = {\n  padding: \"10px 20px\",\n  borderRadius: \"25px\",\n  border: \"1px solid #0073e6\",\n  backgroundColor: \"#0073e6\",\n  color: \"#fff\",\n  fontSize: \"16px\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  transition: \"background-color 0.3s, box-shadow 0.3s\"\n};\nexport default ExcelExportButton;\nvar _c;\n$RefreshReg$(_c, \"ExcelExportButton\");","map":{"version":3,"names":["XLSX","saveAs","React","useEffect","jsxDEV","_jsxDEV","ExcelExportButton","data","_s","console","log","exportToExcel","wb","utils","book_new","wsData","staticHeaders","maxApplicationDates","forEach","person","application_dates","length","dynamicHeaders","i","push","headers","row","user_data","username","idnp","bday","age","loc_name","phone_number","email","program_name","operator","confirmation_date","comment","status","instruction_groups","join","certificate","finance","final_status","exclusion","ws","aoa_to_sheet","columnWidths","map","header","wch","book_append_sheet","wbout","write","bookType","type","blob","Blob","style","buttonContainerStyle","children","onClick","buttonStyle","fileName","_jsxFileName","lineNumber","columnNumber","_c","backgroundColor","display","justifyContent","alignItems","height","padding","borderRadius","border","color","fontSize","fontWeight","cursor","transition","$RefreshReg$"],"sources":["/home/liviu/ODA/front/src/components/ExcelExportButton/index.js"],"sourcesContent":["import * as XLSX from \"xlsx\";\nimport { saveAs } from \"file-saver\";\nimport React, { useEffect } from 'react';\n\nconst ExcelExportButton = ({ data }) => {\n  useEffect(() => {\n    console.log(\"Data passed to ExcelExportButton:\", data); // Log the data\n  }, [data]);\n\n  const exportToExcel = () => {\n    const wb = XLSX.utils.book_new();\n    const wsData = [];\n\n    // Define the static headers\n    const staticHeaders = [\n      \"Nume Prenume\", \"IDNP\", \"Data nașterii\", \"Vârsta\", \"Localitate\", \"Telefon\",\n      \"E-mail\", \"Programul la care aplică\", \"Persoana care a apelat\", \"Data confirmării recepționării formularului / Data apelului\", \"Comentariu în urma discuției\",\n      \"Statut în urma discuției\", \"Participare la instruire\", \"Certificat obținut\", \"Aplicat la finanțare\", \"Statut în urma evaluării planului de afaceri\", \"Excluderea din baza de date\"\n    ];\n\n    // Add dynamic headers for application dates and notices\n    let maxApplicationDates = 0;\n    data.forEach(person => {\n      if (person.application_dates.length > maxApplicationDates) {\n        maxApplicationDates = person.application_dates.length;\n      }\n    });\n\n    const dynamicHeaders = [];\n    for (let i = 0; i < maxApplicationDates; i++) {\n      dynamicHeaders.push(`Data aplicării ${i + 1}`);\n    }\n\n    // Combine static and dynamic headers\n    const headers = [...staticHeaders, ...dynamicHeaders];\n    wsData.push(headers);\n\n    // Map through data to create rows as per the provided template\n    data.forEach((person) => {\n      const row = [\n        person.user_data.username || 'N/A',\n        person.user_data.idnp || 'N/A',\n        person.user_data.bday || 'N/A',\n        person.user_data.age || 'N/A',\n        person.user_data.loc_name || 'N/A',\n        person.user_data.phone_number || 'N/A',\n        person.user_data.email || 'N/A',\n        person.user_data.program_name || 'N/A',\n        person.user_data.operator || 'N/A',\n        person.user_data.confirmation_date || 'N/A',\n        person.user_data.comment || 'N/A',\n        person.user_data.status || 'N/A',\n        person.instruction_groups.join(\", \") || 'N/A',\n        person.user_data.certificate || 'N/A',\n        person.user_data.finance || 'N/A',\n        person.user_data.final_status || 'N/A',\n        person.user_data.exclusion ? 'Exclus' : 'N/A'\n      ];\n\n      // Add dynamic data for application dates\n      for (let i = 0; i < maxApplicationDates; i++) {\n        row.push(person.application_dates[i] || 'N/A');\n      }\n\n      wsData.push(row);\n    });\n\n    // Debugging: Log the wsData array to ensure it has the correct data\n    console.log(wsData);\n\n    // Create worksheet\n    const ws = XLSX.utils.aoa_to_sheet(wsData);\n\n    // Adjust column width for readability\n    const columnWidths = headers.map(header => ({ wch: header.length + 5 }));\n    ws[\"!cols\"] = columnWidths;\n\n    // Append worksheet to workbook\n    XLSX.utils.book_append_sheet(wb, ws, 'PersonDetails');\n\n    // Write workbook and save as file\n    const wbout = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const blob = new Blob([wbout], { type: \"application/octet-stream\" });\n\n    saveAs(blob, \"PersonDetails.xlsx\");\n  };\n\n  return (\n    <div style={buttonContainerStyle}>\n      <button onClick={exportToExcel} style={buttonStyle}>\n        Export to Excel\n      </button>\n    </div>\n  );\n};\n\nconst buttonContainerStyle = {\n  backgroundColor: \"#213b8b\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  height: \"42vh\",\n};\n\nconst buttonStyle = {\n  padding: \"10px 20px\",\n  borderRadius: \"25px\",\n  border: \"1px solid #0073e6\",\n  backgroundColor: \"#0073e6\",\n  color: \"#fff\",\n  fontSize: \"16px\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  transition: \"background-color 0.3s, box-shadow 0.3s\",\n};\n\nexport default ExcelExportButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}