{"ast":null,"code":"var _jsxFileName = \"/home/liviu/ODA/front/src/components/ExcelExportButton/index.js\",\n  _s = $RefreshSig$();\nimport * as XLSX from \"xlsx\";\nimport { saveAs } from \"file-saver\";\nimport React, { useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ExcelExportButton = ({\n  data\n}) => {\n  _s();\n  useEffect(() => {\n    console.log(\"Data passed to ExcelExportButton:\", data);\n  }, [data]);\n  const exportToExcel = () => {\n    const wb = XLSX.utils.book_new();\n    const wsData = [];\n\n    // Define the static headers\n    const staticHeaders = [\"Nume Prenume\", \"IDNP\", \"Data nașterii\", \"Vârsta\", \"Localitate\", \"Telefon\", \"E-mail\", \"Programul la care aplică\", \"Persoana care a apelat\", \"Data confirmării recepționării formularului / Data apelului\", \"Comentariu în urma discuției\", \"Statut în urma discuției\", \"Participare la instruire\", \"Certificat obținut\", \"Aplicat la finanțare\", \"Statut în urma evaluării planului de afaceri\", \"Excluderea din baza de date\"];\n    let maxApplicationDates = 0;\n    let maxNotices = 0;\n    data.forEach(person => {\n      if (person.application_dates.length > maxApplicationDates) {\n        maxApplicationDates = person.application_dates.length;\n      }\n      if (person.notices.length > maxNotices) {\n        maxNotices = person.notices.length;\n      }\n    });\n    const dynamicHeaders = [];\n    for (let i = 0; i < maxApplicationDates; i++) {\n      dynamicHeaders.push(`Data aplicării ${i + 1}`);\n    }\n    for (let i = 0; i < maxNotices; i++) {\n      dynamicHeaders.push(`Inștiințare TELEFON ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare E-MAIL ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare SMS ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare VIBER ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare Răspuns ${i + 1}`);\n    }\n    const headers = [...staticHeaders, ...dynamicHeaders];\n    wsData.push(headers);\n    data.forEach(person => {\n      const row = [person.user_data.username || 'N/A', person.user_data.idnp || 'N/A', person.user_data.bday || 'N/A', person.user_data.age || 'N/A', person.user_data.loc_name || 'N/A', person.user_data.phone_number || 'N/A', person.user_data.email || 'N/A', person.user_data.program_name || 'N/A', person.user_data.operator || 'N/A', person.user_data.confirmation_date || 'N/A', person.user_data.comment || 'N/A', person.user_data.status || 'N/A', person.instruction_groups.join(\", \") || 'N/A', person.user_data.certificate || 'N/A', person.user_data.finance || 'N/A', person.user_data.final_status || 'N/A', person.user_data.exclusion ? 'Exclus' : 'N/A'];\n      for (let i = 0; i < maxApplicationDates; i++) {\n        row.push(person.application_dates[i] || 'N/A');\n      }\n      for (let i = 0; i < maxNotices; i++) {\n        row.push(person.notices[i] ? person.notices[i][0] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][1] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][2] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][3] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][4] || 'N/A' : 'N/A');\n      }\n      wsData.push(row);\n    });\n\n    // Debugging: Log the wsData array to ensure it has the correct data\n    console.log(wsData);\n\n    // Create worksheet\n    const ws = XLSX.utils.aoa_to_sheet(wsData);\n    const columnWidths = headers.map(header => ({\n      wch: header.length + 5\n    }));\n    ws[\"!cols\"] = columnWidths;\n    XLSX.utils.book_append_sheet(wb, ws, 'PersonDetails');\n    const wbout = XLSX.write(wb, {\n      bookType: \"xlsx\",\n      type: \"array\"\n    });\n    const blob = new Blob([wbout], {\n      type: \"application/octet-stream\"\n    });\n    saveAs(blob, \"PersonDetails.xlsx\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: buttonContainerStyle,\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: exportToExcel,\n      style: buttonStyle,\n      children: \"Export to Excel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcelExportButton, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = ExcelExportButton;\nconst buttonContainerStyle = {\n  backgroundColor: \"#213b8b\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  height: \"42vh\"\n};\nconst buttonStyle = {\n  padding: \"10px 20px\",\n  borderRadius: \"25px\",\n  border: \"1px solid #0073e6\",\n  backgroundColor: \"#0073e6\",\n  color: \"#fff\",\n  fontSize: \"16px\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  transition: \"background-color 0.3s, box-shadow 0.3s\"\n};\nexport default ExcelExportButton;\nvar _c;\n$RefreshReg$(_c, \"ExcelExportButton\");","map":{"version":3,"names":["XLSX","saveAs","React","useEffect","jsxDEV","_jsxDEV","ExcelExportButton","data","_s","console","log","exportToExcel","wb","utils","book_new","wsData","staticHeaders","maxApplicationDates","maxNotices","forEach","person","application_dates","length","notices","dynamicHeaders","i","push","headers","row","user_data","username","idnp","bday","age","loc_name","phone_number","email","program_name","operator","confirmation_date","comment","status","instruction_groups","join","certificate","finance","final_status","exclusion","ws","aoa_to_sheet","columnWidths","map","header","wch","book_append_sheet","wbout","write","bookType","type","blob","Blob","style","buttonContainerStyle","children","onClick","buttonStyle","fileName","_jsxFileName","lineNumber","columnNumber","_c","backgroundColor","display","justifyContent","alignItems","height","padding","borderRadius","border","color","fontSize","fontWeight","cursor","transition","$RefreshReg$"],"sources":["/home/liviu/ODA/front/src/components/ExcelExportButton/index.js"],"sourcesContent":["import * as XLSX from \"xlsx\";\nimport { saveAs } from \"file-saver\";\nimport React, { useEffect } from 'react';\n\nconst ExcelExportButton = ({ data }) => {\n  useEffect(() => {\n    console.log(\"Data passed to ExcelExportButton:\", data);\n  }, [data]);\n\n  const exportToExcel = () => {\n    const wb = XLSX.utils.book_new();\n    const wsData = [];\n\n    // Define the static headers\n    const staticHeaders = [\n      \"Nume Prenume\", \"IDNP\", \"Data nașterii\", \"Vârsta\", \"Localitate\", \"Telefon\",\n      \"E-mail\", \"Programul la care aplică\", \"Persoana care a apelat\", \"Data confirmării recepționării formularului / Data apelului\", \"Comentariu în urma discuției\",\n      \"Statut în urma discuției\", \"Participare la instruire\", \"Certificat obținut\", \"Aplicat la finanțare\", \"Statut în urma evaluării planului de afaceri\", \"Excluderea din baza de date\"\n    ];\n\n    let maxApplicationDates = 0;\n    let maxNotices = 0;\n    data.forEach(person => {\n      if (person.application_dates.length > maxApplicationDates) {\n        maxApplicationDates = person.application_dates.length;\n      }\n      if (person.notices.length > maxNotices) {\n        maxNotices = person.notices.length;\n      }\n    });\n\n    const dynamicHeaders = [];\n    for (let i = 0; i < maxApplicationDates; i++) {\n      dynamicHeaders.push(`Data aplicării ${i + 1}`);\n    }\n    for (let i = 0; i < maxNotices; i++) {\n      dynamicHeaders.push(`Inștiințare TELEFON ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare E-MAIL ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare SMS ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare VIBER ${i + 1}`);\n      dynamicHeaders.push(`Inștiințare Răspuns ${i + 1}`);\n    }\n\n    const headers = [...staticHeaders, ...dynamicHeaders];\n    wsData.push(headers);\n\n    data.forEach((person) => {\n      const row = [\n        person.user_data.username || 'N/A',\n        person.user_data.idnp || 'N/A',\n        person.user_data.bday || 'N/A',\n        person.user_data.age || 'N/A',\n        person.user_data.loc_name || 'N/A',\n        person.user_data.phone_number || 'N/A',\n        person.user_data.email || 'N/A',\n        person.user_data.program_name || 'N/A',\n        person.user_data.operator || 'N/A',\n        person.user_data.confirmation_date || 'N/A',\n        person.user_data.comment || 'N/A',\n        person.user_data.status || 'N/A',\n        person.instruction_groups.join(\", \") || 'N/A',\n        person.user_data.certificate || 'N/A',\n        person.user_data.finance || 'N/A',\n        person.user_data.final_status || 'N/A',\n        person.user_data.exclusion ? 'Exclus' : 'N/A'\n      ];\n\n      for (let i = 0; i < maxApplicationDates; i++) {\n        row.push(person.application_dates[i] || 'N/A');\n      }\n\n      for (let i = 0; i < maxNotices; i++) {\n        row.push(person.notices[i] ? person.notices[i][0] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][1] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][2] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][3] || 'N/A' : 'N/A');\n        row.push(person.notices[i] ? person.notices[i][4] || 'N/A' : 'N/A');\n      }\n\n      wsData.push(row);\n    });\n\n    // Debugging: Log the wsData array to ensure it has the correct data\n    console.log(wsData);\n\n    // Create worksheet\n    const ws = XLSX.utils.aoa_to_sheet(wsData);\n\n    const columnWidths = headers.map(header => ({ wch: header.length + 5 }));\n    ws[\"!cols\"] = columnWidths;\n\n    XLSX.utils.book_append_sheet(wb, ws, 'PersonDetails');\n\n    const wbout = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const blob = new Blob([wbout], { type: \"application/octet-stream\" });\n\n    saveAs(blob, \"PersonDetails.xlsx\");\n  };\n\n  return (\n    <div style={buttonContainerStyle}>\n      <button onClick={exportToExcel} style={buttonStyle}>\n        Export to Excel\n      </button>\n    </div>\n  );\n};\n\nconst buttonContainerStyle = {\n  backgroundColor: \"#213b8b\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  height: \"42vh\",\n};\n\nconst buttonStyle = {\n  padding: \"10px 20px\",\n  borderRadius: \"25px\",\n  border: \"1px solid #0073e6\",\n  backgroundColor: \"#0073e6\",\n  color: \"#fff\",\n  fontSize: \"16px\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  transition: \"background-color 0.3s, box-shadow 0.3s\",\n};\n\nexport default ExcelExportButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}